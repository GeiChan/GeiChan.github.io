(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{505:function(a,t,e){"use strict";e.r(t);var s=e(69),r=Object(s.a)({},(function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h2",{attrs:{id:"一、集群规划"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一、集群规划"}},[a._v("#")]),a._v(" 一、集群规划")]),a._v(" "),e("table",[e("thead",[e("tr",[e("th",[a._v("hostname")]),a._v(" "),e("th",[a._v("主机别名")]),a._v(" "),e("th",[a._v("IP")]),a._v(" "),e("th",[a._v("角色")])])]),a._v(" "),e("tbody",[e("tr",[e("td",[a._v("master.hexinfo.com")]),a._v(" "),e("td",[a._v("master")]),a._v(" "),e("td",[a._v("172.18.26.129")]),a._v(" "),e("td",[a._v("Hadoop主节点，CM服务器，数据节点")])]),a._v(" "),e("tr",[e("td",[a._v("node1.hexinfo.com")]),a._v(" "),e("td",[a._v("node1")]),a._v(" "),e("td",[a._v("172.18.25.145")]),a._v(" "),e("td",[a._v("数据节点")])]),a._v(" "),e("tr",[e("td",[a._v("node2.hexinfo.com")]),a._v(" "),e("td",[a._v("node2")]),a._v(" "),e("td",[a._v("172.18.25.60")]),a._v(" "),e("td",[a._v("数据节点，MySQL")])])])]),a._v(" "),e("h2",{attrs:{id:"二、系统环境准备"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二、系统环境准备"}},[a._v("#")]),a._v(" 二、系统环境准备")]),a._v(" "),e("h3",{attrs:{id:"_1、配置网络名称"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、配置网络名称"}},[a._v("#")]),a._v(" 1、配置网络名称")]),a._v(" "),e("h4",{attrs:{id:"_1-1-配置集群中的每一台服务器的主机名-hostname"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-配置集群中的每一台服务器的主机名-hostname"}},[a._v("#")]),a._v(" 1.1 配置集群中的每一台服务器的主机名(HOSTNAME)")]),a._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),e("p",[a._v("主机名必须是FQDN(全限定域名)，且必须唯一")])]),a._v(" "),e("p",[a._v("主机名设置命令："),e("code",[a._v("hostnamectl set-hostname 主机名")])]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 各服务器执行的命令")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 172.18.26.129")]),a._v("\nhostnamectl set-hostname master.hexinfo.com\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 172.18.25.145                            ")]),a._v("\nhostnamectl set-hostname node1.hexinfo.com\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 172.18.25.145")]),a._v("\nhostnamectl set-hostname node2.hexinfo.com\n")])])]),e("h4",{attrs:{id:"_1-2-将集群各机子的ip和全限定域名绑定"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-将集群各机子的ip和全限定域名绑定"}},[a._v("#")]),a._v(" 1.2 将集群各机子的IP和全限定域名绑定")]),a._v(" "),e("p",[a._v("编辑 "),e("code",[a._v("/etc/hosts")]),a._v(" 文件（命令："),e("code",[a._v("vim /etc/hosts")]),a._v("）")]),a._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),e("p",[a._v("配置时，也可以添加非限定域名，即别名")])]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ip 主机名")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("172.18")]),a._v(".26.129 master.hexinfo.com master\n"),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("172.18")]),a._v(".25.145 node1.hexinfo.com node1\n"),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("172.18")]),a._v(".25.60  node2.hexinfo.com node2\n")])])]),e("p",[e("img",{attrs:{src:"https://gitee.com/geichan/picture/raw/master/img/%E9%85%8D%E7%BD%AEIP%E4%B8%8E%E8%A7%92%E8%89%B2%E6%98%A0%E5%B0%84.png",alt:""}})]),a._v(" "),e("h4",{attrs:{id:"_1-3-为集群各节点主机设置hostname"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-为集群各节点主机设置hostname"}},[a._v("#")]),a._v(" 1.3 为集群各节点主机设置hostname")]),a._v(" "),e("p",[a._v("编辑 "),e("code",[a._v("/etc/sysconfig/network")]),a._v(" ，写入一下内容")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# master节点")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("HOSTNAME")])]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("master.hexinfo.com\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# node1节点")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("HOSTNAME")])]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("node1.hexinfo.com\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# node2节点")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("HOSTNAME")])]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("node2.hexinfo.com\n")])])]),e("h3",{attrs:{id:"_2、关闭防火墙"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、关闭防火墙"}},[a._v("#")]),a._v(" 2、关闭防火墙")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看防火墙状态")]),a._v("\nsystemctl status firewalld\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 关闭防火墙")]),a._v("\nsystemctl stop firewalld\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 禁用防火墙")]),a._v("\nsystemctl disable firewalld\n")])])]),e("h3",{attrs:{id:"_3、关闭selinux模式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、关闭selinux模式"}},[a._v("#")]),a._v(" 3、关闭SELinux模式")]),a._v(" "),e("p",[a._v("执行 "),e("code",[a._v("getenforce")]),a._v("，检查SELinux状态")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@master ~"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# getenforce")]),a._v("\nDisabled\n")])])]),e("ul",[e("li",[e("p",[a._v("若输出 "),e("code",[a._v("Permissive")]),a._v(" 或者 "),e("code",[a._v("Disable")]),a._v(" ，则进行下一步；")])]),a._v(" "),e("li",[e("p",[a._v("若输出 "),e("code",[a._v("enforcing")]),a._v("，编辑 "),e("code",[a._v("/etc/selinux/config")]),a._v(" 文件，修改 "),e("code",[a._v("SELINUX=enforcing")]),a._v(" 行的值为 "),e("code",[a._v("SELINUX=Disable")]),a._v(" ，保存后，重启系统 或者执行 "),e("code",[a._v("setenforce 0")]),a._v(" 命令，立即禁用SELinux模式")])])]),a._v(" "),e("h3",{attrs:{id:"_4、同步服务器时间"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4、同步服务器时间"}},[a._v("#")]),a._v(" 4、同步服务器时间")]),a._v(" "),e("p",[a._v("若时间不同步，可以使用 "),e("code",[a._v("ntp")]),a._v(" 服务，同步各节点服务器的时间，以Master节点服务器的时间为准。")]),a._v(" "),e("h3",{attrs:{id:"_5、安装jdk"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5、安装jdk"}},[a._v("#")]),a._v(" 5、安装JDK")]),a._v(" "),e("p",[a._v("在所有服务器上安装JDK：")]),a._v(" "),e("ul",[e("li",[e("p",[a._v("执行命令  "),e("code",[a._v("rpm -qa | grep jdk")]),a._v("，查看是否安装有OpenJDK，若有，则卸载")])]),a._v(" "),e("li",[e("p",[a._v("上传 "),e("code",[a._v("jdk-8u161-linux-x64.rpm")]),a._v(" 到服务器，执行 "),e("code",[a._v("rpm -ivh jdk-8u161-linux-x64.rpm")]),a._v(" 命令，安装JDK")])])]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## 默认安装路径")]),a._v("\n/usr/java/jdk1.8.0_161\n")])])]),e("ul",[e("li",[a._v("使用 "),e("code",[a._v("java -version")]),a._v(" 查看JDK版本，验证是否安装成功")])]),a._v(" "),e("h2",{attrs:{id:"二、上传cm-cloudera-manager-相关rpm包-并安装cm"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二、上传cm-cloudera-manager-相关rpm包-并安装cm"}},[a._v("#")]),a._v(" 二、上传CM(Cloudera Manager)相关RPM包，并安装CM")]),a._v(" "),e("h3",{attrs:{id:"_1、上传cm相关rpm包"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1、上传cm相关rpm包"}},[a._v("#")]),a._v(" 1、上传CM相关rpm包")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@master cm"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ll")]),a._v("\n总用量 "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1380424")]),a._v("\n-rw-r--r-- "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root   "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("10483568")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("月 "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("14")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("17")]),a._v(":43 cloudera-manager-agent-6.3.1-1466458.el7.x86_64.rpm\n-rw-r--r-- "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1203832464")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("月 "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("14")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("17")]),a._v(":52 cloudera-manager-daemons-6.3.1-1466458.el7.x86_64.rpm\n-rw-r--r-- "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root      "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("11488")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("月 "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("14")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("17")]),a._v(":43 cloudera-manager-server-6.3.1-1466458.el7.x86_64.rpm\n")])])]),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@lab-cdh-wml0 cdh"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ll")]),a._v("\n总用量 "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("2033436")]),a._v("\n-rw-r--r-- "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("2082186246")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("月 "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("14")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("17")]),a._v(":32 CDH-6.3.2-1.cdh6.3.2.p0.1605554-el7.parcel\n")])])]),e("p",[a._v("执行命令 "),e("code",[a._v("sha1sum CDH-6.3.2-1.cdh6.3.2.p0.1605554-el7.parcel | awk '{ print $1 }' > CDH-6.3.2-1.cdh6.3.2.p0.1605554-el7.parcel.sha")])]),a._v(" "),e("h3",{attrs:{id:"_2、安装cloudera-manager-server-以及-cloudera-manager-agent"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2、安装cloudera-manager-server-以及-cloudera-manager-agent"}},[a._v("#")]),a._v(" 2、安装Cloudera Manager Server 以及 Cloudera Manager Agent")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 先安装 cloudera-manager-daemons, 这是 Cloudera Manager Agent 的依赖部分")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("rpm")]),a._v(" -ivh cloudera-manager-daemons-6.3.1-1466458.el7.x86_64.rpm \n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 安装 clouder-manager-agent")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("rpm")]),a._v(" -ivh cloudera-manager-agent-6.3.1-1466458.el7.x86_64.rpm\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 安装 clouder-manager-server, 只需要安装master节点")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("rpm")]),a._v(" -ivh cloudera-manager-server-6.3.1-1466458.el7.x86_64.rpm\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),e("p",[a._v("Server 只有 Master 节点需要安装， Agent 所有节点都需要装")]),a._v(" "),e("p",[a._v("若以上命令存在"),e("code",[a._v("依赖检查失败")]),a._v("的问题，加上 "),e("code",[a._v("--nodeps --force")])])]),a._v(" "),e("h3",{attrs:{id:"_3、修改所有节点agent配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3、修改所有节点agent配置"}},[a._v("#")]),a._v(" 3、修改所有节点Agent配置")]),a._v(" "),e("p",[a._v("执行命令 "),e("code",[a._v("vim /etc/cloudera-scm-agent/config.ini")]),a._v("，修改文件中的 "),e("code",[a._v("server_host")]),a._v(" 的值，更改为安装Cloudera Manager Server的服务器全限定域名")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/geichan/picture/raw/master/img/agent%E9%85%8D%E7%BD%AE.png",alt:""}})]),a._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[a._v("WARNING")]),a._v(" "),e("p",[a._v("如果开启了ipv6，这个地方就不能写服务器的hostname了，要使用服务器的 IP 地址，否则CM将无法运行服务监测，会有以下错误")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/geichan/picture/raw/master/img/Host%20Monitor%E6%9C%AA%E8%BF%90%E8%A1%8C.png",alt:""}})])]),a._v(" "),e("h3",{attrs:{id:"_4、为cm使用-安装mysql连接驱动"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4、为cm使用-安装mysql连接驱动"}},[a._v("#")]),a._v(" 4、为CM使用，安装MySQL连接驱动")]),a._v(" "),e("blockquote",[e("p",[a._v("Mysql的安装不多赘述")])]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 下载连接驱动")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" https://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-5.1.46.tar.gz\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 提取jar文件")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" zxvf mysql-connector-java-5.1.46.tar.gz\n")])])]),e("p",[a._v("复制MySQL的驱动jar包到 "),e("code",[a._v("/usr/share/java")]),a._v(" 目录下")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" mysql-connector-java-5.1.46-bin.jar /usr/share/java/mysql-connector-java.jar\n")])])]),e("blockquote",[e("p",[a._v("若不存在  "),e("code",[a._v("/usr/share/java")]),a._v("  目录，则手动创建一个")])]),a._v(" "),e("h3",{attrs:{id:"_5、为clouder创建数据库"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5、为clouder创建数据库"}},[a._v("#")]),a._v(" 5、为Clouder创建数据库")]),a._v(" "),e("p",[a._v("为需要使数据库的组件创建数据库：")]),a._v(" "),e("ul",[e("li",[a._v("Cloudera Manager Server")]),a._v(" "),e("li",[a._v("Cloudera Manager Service roles (分为 "),e("code",[a._v("Activity Monitor")]),a._v(" (活动监视器) 和 "),e("code",[a._v("Reports Manager")]),a._v(" (报表管理器))")]),a._v(" "),e("li",[a._v("Hue")]),a._v(" "),e("li",[a._v("Hive 元数据存储")]),a._v(" "),e("li",[a._v("Sentry Server")]),a._v(" "),e("li",[a._v("Cloudera Navigator Audit Server")]),a._v(" "),e("li",[a._v("Cloudera Navigator Metadata Server")]),a._v(" "),e("li",[a._v("Oozie")])]),a._v(" "),e("table",[e("thead",[e("tr",[e("th",[a._v("服务组件")]),a._v(" "),e("th",[a._v("数据库名")]),a._v(" "),e("th",[a._v("用户名")])])]),a._v(" "),e("tbody",[e("tr",[e("td",[a._v("Cloudera Manager Server")]),a._v(" "),e("td",[a._v("scm")]),a._v(" "),e("td",[a._v("scm")])]),a._v(" "),e("tr",[e("td",[a._v("Activity Monitor")]),a._v(" "),e("td",[a._v("amon")]),a._v(" "),e("td",[a._v("amon")])]),a._v(" "),e("tr",[e("td",[a._v("Reports Manager")]),a._v(" "),e("td",[a._v("rman")]),a._v(" "),e("td",[a._v("rman")])]),a._v(" "),e("tr",[e("td",[a._v("Hue")]),a._v(" "),e("td",[a._v("hue")]),a._v(" "),e("td",[a._v("hue")])]),a._v(" "),e("tr",[e("td",[a._v("Hive 元数据")]),a._v(" "),e("td",[a._v("metastore")]),a._v(" "),e("td",[a._v("hive")])]),a._v(" "),e("tr",[e("td",[a._v("Sentry Server")]),a._v(" "),e("td",[a._v("sentry")]),a._v(" "),e("td",[a._v("sentry")])]),a._v(" "),e("tr",[e("td",[a._v("Cloudera Navigator Audit Server")]),a._v(" "),e("td",[a._v("nav")]),a._v(" "),e("td",[a._v("nav")])]),a._v(" "),e("tr",[e("td",[a._v("Cloudera Navigator Metadata Server")]),a._v(" "),e("td",[a._v("navms")]),a._v(" "),e("td",[a._v("navms")])]),a._v(" "),e("tr",[e("td",[a._v("Oozie")]),a._v(" "),e("td",[a._v("oozie")]),a._v(" "),e("td",[a._v("oozie")])])])]),a._v(" "),e("div",{staticClass:"language-mysql extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("-- 创建 Cloudera Manager Server 用户和数据库\nCREATE DATABASE IF NOT EXISTS scm DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;\nCREATE USER 'scm'@'%' IDENTIFIED BY 'scm';\nGRANT ALL ON scm.* TO 'scm'@'%' IDENTIFIED BY 'scm';\n\n-- 创建 Activity Monitor 用户和数据库\nCREATE DATABASE IF NOT EXISTS amon DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;\nCREATE USER 'amon'@'%' IDENTIFIED BY 'amon';\nGRANT ALL ON amon.* TO 'amon'@'%' IDENTIFIED BY 'amon';\n\n-- 创建 Reports Manager 用户和数据库\nCREATE DATABASE IF NOT EXISTS rman DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;\nCREATE USER 'rman'@'%' IDENTIFIED BY 'rman';\nGRANT ALL ON rman.* TO 'rman'@'%' IDENTIFIED BY 'rman';\n\n-- 创建 Hue 用户和数据库\nCREATE DATABASE IF NOT EXISTS hue DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;\nCREATE USER 'hue'@'%' IDENTIFIED BY 'hue';\nGRANT ALL ON hue.* TO 'hue'@'%' IDENTIFIED BY 'hue';\n\n-- 创建 Hive 元数据 用户和数据库\nCREATE DATABASE IF NOT EXISTS hive DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;\nCREATE USER 'hive'@'%' IDENTIFIED BY 'hive';\nGRANT ALL ON hive.* TO 'hive'@'%' IDENTIFIED BY 'hive';\n\n-- 创建 Sentry Server 用户和数据库\nCREATE DATABASE IF NOT EXISTS sentry DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;\nCREATE USER 'sentry'@'%' IDENTIFIED BY 'sentry';\nGRANT ALL ON sentry.* TO 'sentry'@'%' IDENTIFIED BY 'sentry';\n\n-- 创建 Cloudera Navigator Audit Server 用户和数据库\nCREATE DATABASE nav DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;\nCREATE USER 'nav'@'%' IDENTIFIED BY 'nav';\nGRANT ALL ON nav.* TO 'nav'@'%' IDENTIFIED BY 'nav';\n\n-- 创建 Cloudera Navigator Metadata Server 用户和数据库\nCREATE DATABASE IF NOT EXISTS navms DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;\nCREATE USER 'navms'@'%' IDENTIFIED BY 'navms';\nGRANT ALL ON navms.* TO 'navms'@'%' IDENTIFIED BY 'navms';\n\n-- 创建 Oozie 用户和数据库\nCREATE DATABASE IF NOT EXISTS oozie DEFAULT CHARACTER SET utf8 DEFAULT COLLATE utf8_general_ci;\nCREATE USER 'oozie'@'%' IDENTIFIED BY 'oozie';\nGRANT ALL ON oozie.* TO 'oozie'@'%' IDENTIFIED BY 'oozie';\n")])])]),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[a._v("WARNING")]),a._v(" "),e("p",[a._v("使用以上语句时，可能存在"),e("code",[a._v("Your password does not satisfy the current policy requirements")]),a._v(" 错误，是由于数据库用户的密码过于简单导致的")]),a._v(" "),e("p",[a._v("如果是开发或者测试环境，建议 在 "),e("code",[a._v("/etc/my.cnf")]),a._v(" 中添加一段 "),e("code",[a._v("validate_password=off")]),a._v(" ，关闭密码策略")]),a._v(" "),e("p",[a._v("当然你也可以设置更为复杂的密码")])]),a._v(" "),e("h3",{attrs:{id:"_6、设置cloudera-manager数据库"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6、设置cloudera-manager数据库"}},[a._v("#")]),a._v(" 6、设置Cloudera Manager数据库")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("/opt/cloudera/cm/schema/scm_prepare_database.sh mysql scm scm scm\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 若数据库所在的服务器与Cloudera Manager Server所在服务不是同一台的话，使用一下命令")]),a._v("\n/opt/cloudera/cm/schema/scm_prepare_database.sh -h "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("host"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" -P "),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("port"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" mysql scm scm scm\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),e("p",[e("code",[a._v("scm_prepare_database.sh")]),a._v(" 脚本语法：")]),a._v(" "),e("p",[e("code",[a._v("/opt/cloudera/cm/schema/scm_prepare_database.sh [options] <databaseType> <databaseName> <databaseUser> <password>")])])]),a._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/geichan/picture/raw/master/img/%E8%AE%BE%E7%BD%AECloudera%20Manager%20Server%E6%95%B0%E6%8D%AE%E5%BA%93%E6%88%90%E5%8A%9F.png",alt:""}})]),a._v(" "),e("h3",{attrs:{id:"_7、启动cloudera-manager-server-以及-cloudera-manager-agent"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_7、启动cloudera-manager-server-以及-cloudera-manager-agent"}},[a._v("#")]),a._v(" 7、启动Cloudera Manager Server 以及 Cloudera Manager Agent")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 启动 Cloudera Manager 服务")]),a._v("\nsystemctl start cloudera-scm-server.service\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 查看启动日志")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[a._v("tail")]),a._v(" -f /var/log/cloudera-scm-server/cloudera-scm-server.log\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Cloudera Manager Server 启动完成后，各节点服务器启动 Cloudera Manager Agent")]),a._v("\nsystemctl start cloudera-scm-agent.service\n")])])]),e("blockquote",[e("p",[e("code",[a._v("INFO WebServerImpl:com.cloudera.server.cmf.WebServerImpl: Started Jetty server.")])]),a._v(" "),e("p",[a._v("出现该信息时，表示服务启动完毕！")])]),a._v(" "),e("h3",{attrs:{id:"_8、浏览器中访问cloudera-manager"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_8、浏览器中访问cloudera-manager"}},[a._v("#")]),a._v(" 8、浏览器中访问Cloudera Manager")]),a._v(" "),e("p",[a._v("浏览器中访问："),e("code",[a._v("http://主机ip:7180")])]),a._v(" "),e("p",[a._v("默认凭证：")]),a._v(" "),e("ul",[e("li",[a._v("用户：admin")]),a._v(" "),e("li",[a._v("密码：admin")])]),a._v(" "),e("h3",{attrs:{id:"_9、集群设置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9、集群设置"}},[a._v("#")]),a._v(" 9、集群设置")]),a._v(" "),e("p",[a._v("登录页面会有Welcome欢迎页，一直继续，选择版本页面，可以选择60天试用的企业版")]),a._v(" "),e("h4",{attrs:{id:"_9-1-集群安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9-1-集群安装"}},[a._v("#")]),a._v(" 9.1 集群安装")]),a._v(" "),e("h5",{attrs:{id:"_9-1-1-cluster-basics"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9-1-1-cluster-basics"}},[a._v("#")]),a._v(" 9.1.1 Cluster Basics")]),a._v(" "),e("p",[a._v("输入群集名称，然后单击 "),e("em",[a._v("继续")])]),a._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),e("p",[a._v("Cluster Basics：允许用户指定"),e("strong",[a._v("集群名称")]),a._v("，并选择"),e("strong",[a._v("集群类型")])]),a._v(" "),e("ul",[e("li",[a._v("常规集群：查柜集群包含存储节点、计算节点和其他服务，如单个集群中并存的元数据和安全")]),a._v(" "),e("li",[a._v("计算集群：计算集群"),e("strong",[a._v("仅由计算节点组成")]),a._v("，若要连接到现有存储、元数据或安全服务，必须先在基础集群上选择或创建数据上下文")])]),a._v(" "),e("p",[a._v("Tips：新安装时，只能选择"),e("strong",[a._v("常规集群")]),a._v("。如果没有常规集群，则无法添加计算集群")])]),a._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/geichan/picture/raw/master/img/%E9%9B%86%E7%BE%A4%E5%AE%89%E8%A3%85%E2%80%94%E2%80%94Cluster%20Basics.png",alt:""}})]),a._v(" "),e("h5",{attrs:{id:"_9-1-2-specify-hosts"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9-1-2-specify-hosts"}},[a._v("#")]),a._v(" 9.1.2 Specify Hosts")]),a._v(" "),e("p",[a._v("指定哪些主机将运行CDH和其他托管服务")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/geichan/picture/raw/master/img/%E9%9B%86%E7%BE%A4%E5%AE%89%E8%A3%85%E2%80%94%E2%80%94%E6%8C%87%E5%AE%9A%E4%B8%BB%E6%9C%BA.png",alt:""}})]),a._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),e("p",[a._v("若没有"),e("code",[a._v("当前管理主机")]),a._v(" 这栏，可能未启动Cloudera Manager Agent。")]),a._v(" "),e("p",[a._v("可以使用"),e("code",[a._v("systemctl status cloudera-scm-agent.service")]),a._v(" 查看一下启动状态，未启动的话，使用"),e("code",[a._v("systemctl start cloudera-scm-agent.service")]),a._v("启动，然后刷新页面即可")])]),a._v(" "),e("h5",{attrs:{id:"_9-1-3-选择存储库"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9-1-3-选择存储库"}},[a._v("#")]),a._v(" 9.1.3 选择存储库")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/geichan/picture/raw/master/img/%E9%9B%86%E7%BE%A4%E5%AE%89%E8%A3%85%E2%80%94%E2%80%94%E9%80%89%E6%8B%A9%E5%AD%98%E5%82%A8%E5%BA%93.png",alt:""}})]),a._v(" "),e("h6",{attrs:{id:"cdh-and-other-software-部分"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cdh-and-other-software-部分"}},[a._v("#")]),a._v(" CDH and other software 部分")]),a._v(" "),e("p",[a._v("选择安装方法")]),a._v(" "),e("ul",[e("li",[e("p",[a._v("使用数据包\n一种标准的二进制分发格式，包含已编译的代码和元信息。使用操作系统的包管理器安装包")])]),a._v(" "),e("li",[e("p",[a._v("使用Parcel（推荐）")]),a._v(" "),e("p",[a._v("Parcel 是包含程序文件的二进制分发格式，以及Cloudera Manager使用的其他元数据。")])])]),a._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[a._v("WARNING")]),a._v(" "),e("p",[a._v("注意：如果使用 Parcel 安装，需要在"),e("code",[a._v("其他Parcel")]),a._v(" 选择需要安装的 Parcel。")]),a._v(" "),e("p",[a._v("特别提醒：如果安装CDH 6，请勿选择KAFKA、KUDU、SPARK的Parcel，因为CDH 6中已经包含了这些 Parcel")])]),a._v(" "),e("h5",{attrs:{id:"_9-1-4-install-parcel"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9-1-4-install-parcel"}},[a._v("#")]),a._v(" 9.1.4 Install Parcel")]),a._v(" "),e("p",[a._v("等待Parcel安装完成，"),e("em",[a._v("继续")]),a._v(" 即可。")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/geichan/picture/raw/master/img/%E9%9B%86%E7%BE%A4%E5%AE%89%E8%A3%85%E2%80%94%E2%80%94%E5%AE%89%E8%A3%85CDH%20Parcel.png",alt:""}})]),a._v(" "),e("h5",{attrs:{id:"_9-1-5-inspect-cluster"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9-1-5-inspect-cluster"}},[a._v("#")]),a._v(" 9.1.5 Inspect Cluster")]),a._v(" "),e("p",[a._v("点击这两个位置的 "),e("code",[a._v("Inspect Network Performance")]),a._v(" 和 "),e("code",[a._v("Inspect Hosts")]),a._v("。")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/geichan/picture/raw/master/img/Inspect%20Cluster.png",alt:""}})]),a._v(" "),e("p",[a._v("检查完毕后，解决报告中的问题。若无法解决，直接选择第三项，“我理解风险，让我继续创建集群”，然后点击继续。")]),a._v(" "),e("h4",{attrs:{id:"_9-2-集群相关配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9-2-集群相关配置"}},[a._v("#")]),a._v(" 9.2 集群相关配置")]),a._v(" "),e("h5",{attrs:{id:"_9-2-1-选择服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9-2-1-选择服务"}},[a._v("#")]),a._v(" 9.2.1 选择服务")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/geichan/picture/raw/master/img/%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E2%80%94%E2%80%94%E9%80%89%E6%8B%A9%E6%9C%8D%E5%8A%A1.png",alt:""}})]),a._v(" "),e("h5",{attrs:{id:"_9-2-2-自定义角色分配"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9-2-2-自定义角色分配"}},[a._v("#")]),a._v(" 9.2.2 自定义角色分配")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/geichan/picture/raw/master/img/%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E2%80%94%E2%80%94%E8%87%AA%E5%AE%9A%E4%B9%89%E9%80%89%E6%8B%A9.png",alt:""}})]),a._v(" "),e("h5",{attrs:{id:"_9-2-3-数据库设置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9-2-3-数据库设置"}},[a._v("#")]),a._v(" 9.2.3 数据库设置")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/geichan/picture/raw/master/img/%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E2%80%94%E2%80%94%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E7%BD%AE.png",alt:""}})]),a._v(" "),e("p",[a._v("选择使用的数据库类型，并填入先前创建的数据库连接信息，点击测试连接，正常连接即可。")]),a._v(" "),e("h5",{attrs:{id:"_9-2-4-审核更改"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9-2-4-审核更改"}},[a._v("#")]),a._v(" 9.2.4 审核更改")]),a._v(" "),e("p",[a._v("查看并进行必要的更改即可。一般默认即可，直接继续。")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/geichan/picture/raw/master/img/%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E2%80%94%E2%80%94%E5%AE%A1%E6%A0%B8%E6%9B%B4%E6%94%B9.png",alt:""}})]),a._v(" "),e("h5",{attrs:{id:"_9-2-5-命令详细信息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9-2-5-命令详细信息"}},[a._v("#")]),a._v(" 9.2.5 命令详细信息")]),a._v(" "),e("p",[a._v("会列出运行命令的详细信息。首次安装完成后，点击继续即可。")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/geichan/picture/raw/master/img/%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E2%80%94%E2%80%94%E9%A6%96%E6%AC%A1%E5%AE%89%E8%A3%85.png",alt:""}})]),a._v(" "),e("h5",{attrs:{id:"_9-2-6-汇总"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9-2-6-汇总"}},[a._v("#")]),a._v(" 9.2.6 汇总")]),a._v(" "),e("p",[a._v("报告设置向导的安装结果。点击完成即可。")]),a._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/geichan/picture/raw/master/img/%E9%9B%86%E7%BE%A4%E9%85%8D%E7%BD%AE%E2%80%94%E2%80%94%E5%AE%8C%E6%88%90.png",alt:""}})]),a._v(" "),e("p",[a._v("到此，即安装完毕了！剩下的就是组件的配置了。")])])}),[],!1,null,null,null);t.default=r.exports}}]);