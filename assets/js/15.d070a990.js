(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{504:function(s,t,e){"use strict";e.r(t);var a=e(69),n=Object(a.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),e("p",[s._v("本文安装的Mysql 5.7，当然，如果需要更高版本的，可以按照 "),e("code",[s._v("Step.4")]),s._v(" 修改文件中的"),e("code",[s._v("enable")]),s._v("的值（1：启用，0：关闭）即可。")])]),s._v(" "),e("h2",{attrs:{id:"step-1-检查并卸载系统原装mysql"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#step-1-检查并卸载系统原装mysql"}},[s._v("#")]),s._v(" Step.1 检查并卸载系统原装MySQL")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("执行命令 "),e("code",[s._v("rpm -qa | grep mysql")]),s._v("，查找系统是否装有 MySQL")])]),s._v(" "),e("li",[e("p",[s._v("若已安装 MySQL，需要停止 MySQL 服务，并删除之前安装的 MySQL")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止MySQL服务")]),s._v("\nsystemctl stop mysqld\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除软件命令（需要删除已有的所有MySQL的rpm包）")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -e --nodeps 包名\n")])])])]),s._v(" "),e("li",[e("p",[s._v("删除老版本的 MySQL 目录以及 MySQL 的配置等")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查找 mysql 相关的目录")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" / -name mysql\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除老版本mysql的文件")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf my.cnf 以及 my.cnf.d 的目录\n")])])])])]),s._v(" "),e("h2",{attrs:{id:"step-2-yum-设置阿里源-阿里镜像mysql下载快"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#step-2-yum-设置阿里源-阿里镜像mysql下载快"}},[s._v("#")]),s._v(" Step.2 yum 设置阿里源 (阿里镜像MySQL下载快)")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. 备份原先的镜像文件")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /etc/yum.repos.d\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" CentOS-Base.repo CentOS-Base.repo.backup\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. 下载阿里云的 CentOS-Base.repo 到 /etc/yum.repos.d/ 目录下")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo\t\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3. 清理 yum 软件源缓存")]),s._v("\nyum clean all\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4. 生成新的 yum 元数据缓存")]),s._v("\nyum makecache\n")])])]),e("h2",{attrs:{id:"step-3-下载配置mysql的rpm包"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#step-3-下载配置mysql的rpm包"}},[s._v("#")]),s._v(" Step.3 下载配置MySQL的rpm包")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 自行创建mysql rpm包的存放路径")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.下载rpm包")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://repo.mysql.com//mysql80-community-release-el7-3.noarch.rpm\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.安装myaql源")]),s._v("\nyum localinstall -y mysql80-community-release-el7-3.noarch.rpm\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3.检查MySQL源是否安装成功，此时查到的安装包的版本都是mysql8.0版本的")]),s._v("\nyum repolist enabled "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mysql.*-community.*"')]),s._v("\n")])])]),e("p",[e("img",{attrs:{src:"https://gitee.com/geichan/picture/raw/master/img/mysql%E6%BA%90%E7%9A%84%E5%AE%89%E8%A3%85%E7%BB%93%E6%9E%9C.png",alt:""}})]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4.修改yum源配置文件，获取自己想要安装的mysql5.7版本")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/yum.repos.d/mysql-community.repo\n")])])]),e("p",[e("img",{attrs:{src:"https://gitee.com/geichan/picture/raw/master/img/mysql%E6%BA%90%E9%85%8D%E7%BD%AE%E4%BF%AE%E6%94%B9.png",alt:""}})]),s._v(" "),e("p",[s._v("修改红框中的内容，将 MySQL 5.7 的 "),e("code",[s._v("enabled=0")]),s._v(" 改为 "),e("code",[s._v("enabled=1")]),s._v("，将 MySQL 8.0 的 "),e("code",[s._v("enabled=1")]),s._v(" 改为 "),e("code",[s._v("enabled=0")]),s._v("，保存退出后，重新执行命令 "),e("code",[s._v('yum repolist enabled | grep "mysql.*-community.*"')]),s._v("，查看当前 MySQL 源版本是否是 5.7")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/geichan/picture/raw/master/img/%E4%BF%AE%E6%94%B9%E5%90%8E%E7%9A%84MySQL%E6%BA%90%E7%89%88%E6%9C%AC.png",alt:""}})]),s._v(" "),e("h2",{attrs:{id:"step-4-安装mysql"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#step-4-安装mysql"}},[s._v("#")]),s._v(" Step.4 安装MySQL")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("yum -y "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" mysql-community-server\n")])])]),e("h2",{attrs:{id:"step-5-启动mysql服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#step-5-启动mysql服务"}},[s._v("#")]),s._v(" Step.5 启动MySQL服务")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.临时启动mysql服务")]),s._v("\nsystemctl start mysqld\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.开机启动mysql服务")]),s._v("\nsystemctl "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" mysqld\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3.查看MySQL的启动状态")]),s._v("\nsystemctl status mysqld\n")])])]),e("h2",{attrs:{id:"step-6-修改mysql本地的root登录密码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#step-6-修改mysql本地的root登录密码"}},[s._v("#")]),s._v(" Step.6 修改MySQL本地的root登录密码")]),s._v(" "),e("p",[s._v("MySQL 安装完成后，在 "),e("code",[s._v("/var/log/mysqld.log")]),s._v(" 文件中，可以找到安装 MySQL 时自动生成的 root 密码")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'temporary password'")]),s._v(" /var/log/mysqld.log\n")])])]),e("p",[e("img",{attrs:{src:"https://gitee.com/geichan/picture/raw/master/img/MySQL%E7%9A%84%E9%BB%98%E8%AE%A4root%E5%AF%86%E7%A0%81.png",alt:""}})]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.使用以上找到的密码登录MySQL")]),s._v("\nmysql -u root -p\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. 修改root用户密码")]),s._v("\nALTER "),e("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v("@"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost'")]),s._v(" IDENTIFIED BY "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Shhex!1324'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3. 开启用户远程登录")]),s._v("\nGRANT ALL PRIVILEGES ON *.* TO "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v("@"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),s._v(" IDENTIFIED BY "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Shhex!1324'")]),s._v(" WITH GRANT OPTION"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nFLUSH PRIVILEGES"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),e("p",[s._v("如果是开发或者测试环境，建议 在 "),e("code",[s._v("/etc/my.cnf")]),s._v(" 中添加一段 "),e("code",[s._v("validate_password=off")]),s._v(" ，关闭密码策略。（修改配置文件后，需要重启mysql服务，命令行"),e("code",[s._v("systemctl restart mysqld")]),s._v("）")])]),s._v(" "),e("h2",{attrs:{id:"常见问题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#常见问题"}},[s._v("#")]),s._v(" 常见问题")]),s._v(" "),e("p",[s._v("执行 "),e("code",[s._v("yum -y install mysql-community-server")]),s._v("，如遇以下问题")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('源 "MySQL 5.7 Community Server" 的 GPG 密钥已安装，但是不适用于此软件包。请检查源的公钥 URL 是否配置正确。\n')])])]),e("p",[s._v("官方有说到：")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("If you are using RPM 4.1 and it complains about (GPG) NOT OK (MISSING KEYS: GPG#3a79bd29), even though you have imported the MySQL public build key into your own GPG keyring, you need to import the key into the RPM keyring first. RPM 4.1 no longer uses your personal GPG keyring (or GPG itself). Rather, RPM maintains a separate keyring because it is a system-wide application and a user’s GPG public keyring is a user-specific file. To import the MySQL public key into the RPM keyring, first obtain the key, then use rpm --import to import the key\n")])])]),e("p",[s._v("可以执行一下命令行解决：")]),s._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" --import https://repo.mysql.com/RPM-GPG-KEY-mysql-2022\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);